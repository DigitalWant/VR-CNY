function Head(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".headSwiperType",this.putOn=["ctx1","ctx3"]}function Fringe(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".fringeSwiperType",this.putOn=["ctx2","ctx4"]}function Eye(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".eyeSwiperType",this.putOn=["ctx1","ctx3"]}function Mouth(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".mouthSwiperType",this.putOn=["ctx1","ctx3"]}function Background(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".backgroundSwiperType",this.putOn=["ctx3"]}function Body(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".skip",this.putOn=["ctx3"]}function Cloth(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".clothSwiperType",this.putOn=["ctx3"]}function Bag(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".bagSwiperType",this.putOn=["ctx5"]}function Shoes(e,a,t,i,n,o,s){this.x=e,this.y=a,this.x2=t,this.y2=i,this.w=n,this.h=o,this.image=s,this.iSpr=0,this.domEle=".shoesSwiperType",this.putOn=["ctx3"]}function checkPortrait(){document.documentElement.clientHeight>document.documentElement.clientWidth?$("body").removeClass("portraitPls"):$("body").addClass("portraitPls")}function clearFace(){ctx.clearRect(0,0,ctx.canvas.width,ctx.canvas.height),ctx2.clearRect(0,0,ctx2.canvas.width,ctx2.canvas.height)}function clearBody(){ctx3.clearRect(0,0,ctx3.canvas.width,ctx3.canvas.height),ctx4.clearRect(0,0,ctx4.canvas.width,ctx4.canvas.height),ctx5.clearRect(0,0,ctx5.canvas.width,ctx5.canvas.height)}function drawFaceScene(){clearFace();for(var e=0;e<faceObject.length;e++)"ctx1"==faceObject[e].putOn[0]&&ctx.drawImage(faceObject[e].image,faceObject[e].x2+faceObject[e].iSpr*faceObject[e].w,faceObject[e].y2,faceObject[e].w,faceObject[e].h,faceObject[e].x+headPosX_onFacebuild,faceObject[e].y+headPosY_onFacebuild,faceObject[e].w*headScaleW_onFacebuild,faceObject[e].h*headScaleH_onFacebuild),"ctx2"==faceObject[e].putOn[0]&&ctx2.drawImage(faceObject[e].image,faceObject[e].x2+faceObject[e].iSpr*faceObject[e].w,faceObject[e].y2,1*faceObject[e].w,1*faceObject[e].h,faceObject[e].x+headPosX_onFacebuild,faceObject[e].y+headPosY_onFacebuild,faceObject[e].w*headScaleW_onFacebuild,faceObject[e].h*headScaleH_onFacebuild)}function drawBodyScene(){clearBody();for(var e=0;e<bodyObject.length;e++){var a=document.createElement("canvas"),t=a.getContext("2d"),i=document.createElement("canvas"),n=i.getContext("2d"),o=document.createElement("canvas");i.getContext("2d");a.width=320,a.height=570,i.width=160,i.height=285,o.width=80,o.height=142.5,t.drawImage(canvas,0,0,a.width,a.height,0,0,i.width,i.height),t.drawImage(canvas2,0,0,a.width,a.height,0,0,i.width,i.height),n.drawImage(a,0,0,i.width,i.height,0,0,o.width,o.height),"female"==gender?ctx4.drawImage(i,0,0,o.width,o.height,headPosX_female_onBodybuild,headPosY_female_onBodybuild,headScaleW_female_onBodybuild,headScaleH_female_onBodybuild):ctx4.drawImage(i,0,0,o.width,o.height,headPosX_male_onBodybuild,headPosY_male_onBodybuild,headScaleW_male_onBodybuild,headScaleH_male_onBodybuild),"ctx3"==bodyObject[e].putOn[0]&&ctx3.drawImage(bodyObject[e].image,bodyObject[e].x2+bodyObject[e].iSpr*bodyObject[e].w,bodyObject[e].y2,1*bodyObject[e].w,1*bodyObject[e].h,bodyObject[e].x+bodyPosX_onBodybuild,bodyObject[e].y+bodyPosY_onBodybuild,bodyObject[e].w*bodyScaleW_onBodybuild,bodyObject[e].h*bodyScaleH_onBodybuild),"ctx5"==bodyObject[e].putOn[0]&&ctx5.drawImage(bodyObject[e].image,bodyObject[e].x2+bodyObject[e].iSpr*bodyObject[e].w,bodyObject[e].y2,1*bodyObject[e].w,1*bodyObject[e].h,bodyObject[e].x+bodyPosX_onBodybuild,bodyObject[e].y+bodyPosY_onBodybuild,bodyObject[e].w*bodyScaleW_onBodybuild,bodyObject[e].h*bodyScaleH_onBodybuild)}1==shoesBeforeCloth&&ctx3.drawImage(bodyObject[2].image,bodyObject[2].x2+bodyObject[2].iSpr*bodyObject[2].w,bodyObject[2].y2,1*bodyObject[2].w,1*bodyObject[2].h,bodyObject[2].x+bodyPosX_onBodybuild,bodyObject[2].y+bodyPosY_onBodybuild,bodyObject[2].w*bodyScaleW_onBodybuild,bodyObject[2].h*bodyScaleH_onBodybuild),ctx6.drawImage(canvas3,0,0,bodyCanvasWidth,bodyCanvasHeight,0,0,bodyCanvasWidth*bodyScaleW_onMakeWishbuild,bodyCanvasHeight*bodyScaleH_onMakeWishbuild),ctx6.drawImage(canvas4,0,0,bodyCanvasWidth,bodyCanvasHeight,0,0,bodyCanvasWidth*bodyScaleW_onMakeWishbuild,bodyCanvasHeight*bodyScaleH_onMakeWishbuild),1==app.bodyItemHasBag&&ctx6.drawImage(canvas5,0,0,bodyCanvasWidth,bodyCanvasHeight,0,0,bodyCanvasWidth*bodyScaleW_onMakeWishbuild,bodyCanvasHeight*bodyScaleH_onMakeWishbuild)}function exportResult(){userMsg.text=$("#msg").val(),userMsg.context=ctx6,ctx6.font=userMsg.font,ctx6.fillStyle=userMsg.fillStyle,wrapText(userMsg.context,userMsg.text,userMsg.x,userMsg.y,userMsg.maxWidth,userMsg.lineHeight);var e,a;a=document.createElement("canvas"),e=a.getContext("2d"),a.width=bodyCanvasWidth,a.height=bodyCanvasHeight;var t=ctx6.getImageData(0,0,bodyCanvasWidth,bodyCanvasHeight);e.putImageData(t,0,0);var i=a.toDataURL("image/jpeg",1);$("#body_result").attr("src",i),$("#share_result").attr("src",i)}function sendResultToServer(e){$(".scene .loading").show(),$.post(website_url+"accept_avatar.php",{data:e},function(e){e&&$(".result").fadeOut(1e3,function(){var a='<hr /><div class="container"><h2>Result is:</h2><img src="cache/result'+e+'.jpg" /><button class="button download" onclick="window.open(\'cache/result'+e+'.jpg\');">download result image</button><button class="button" onclick="$(\'.send_email\').toggle();">Send by Email</button><form method="post" action="email.php" class="send_email"><input name="file" value="'+e+'" type="hidden" /><input class="text" name="name" value="" type="text" placeholder="Your Name" /><input class="text" name="email" value="" type="text" placeholder="Your Email" /><input class="button" type="submit" name="submit" /></form></div>';$(this).html(a),$(this).fadeIn(1e3),$(".scene .loading").hide()})})}function wrapText(e,a,t,i,n,o){for(var s=a.split(""),c="",d=0;d<s.length;d++){var r=c+s[d]+"",l=e.measureText(r),p=l.width;p>n&&d>0?(e.fillText(c,t,i),c=s[d]+"",i+=o):c=r}e.textAlign="center",e.fillText(c,t,i)}function assetsPrepareForFace(e,a){"number"==typeof timer&&clearInterval(timer),canvas=document.getElementById("scene"),ctx=canvas.getContext("2d"),canvas2=document.getElementById("scene2"),ctx2=canvas2.getContext("2d");var t=new Image;t.src=website_url+"images/data/"+e+"/eyes.png",t.onload=function(){};var i=new Image;i.src=website_url+"images/data/"+e+"/mouths.png",i.onload=function(){};var n=new Image;n.src=website_url+"images/data/"+e+"/face.png",n.onload=function(){};var o=new Image;o.src=website_url+"images/data/"+e+"/fringes.png",o.onload=function(){},faceObject[0]=new Head(0,20,0,0,faceCanvasWidth,200,n),faceObject[1]=new Fringe(0,-60,0,0,faceCanvasWidth,500,o),faceObject[2]=new Eye(0,20,0,0,faceCanvasWidth,200,t),faceObject[3]=new Mouth(0,20,0,0,faceCanvasWidth,200,i),timer=setInterval(drawFaceScene,100)}function assetsPrepareForBody(e,a){"number"==typeof timer2&&clearInterval(timer2),canvas3=document.getElementById("scene3"),ctx3=canvas3.getContext("2d"),canvas4=document.getElementById("scene4"),ctx4=canvas4.getContext("2d"),canvas5=document.getElementById("scene5"),ctx5=canvas5.getContext("2d"),canvas6=document.getElementById("scene6"),ctx6=canvas6.getContext("2d");var t=new Image;t.src=website_url+"images/data/background.png",t.onload=function(){};var i=new Image;i.src=website_url+"images/data/"+e+"/body.png",i.onload=function(){};var n=new Image;n.src=website_url+"images/data/"+e+"/cloth.png",n.onload=function(){};var o=new Image;o.src=website_url+"images/data/"+e+"/bag.png",o.onload=function(){};var s=new Image;s.src=website_url+"images/data/"+e+"/shoes.png",s.onload=function(){},bodyObject[0]=new Background(0,0,0,0,bodyCanvasWidth,bodyCanvasHeight,t),bodyObject[1]=new Body(0,0,0,0,bodyCanvasWidth,bodyCanvasHeight,i),bodyObject[2]=new Shoes(0,0,0,0,bodyCanvasWidth,bodyCanvasHeight,s),bodyObject[3]=new Cloth(0,0,0,0,bodyCanvasWidth,bodyCanvasHeight,n),bodyObject[4]=new Bag(0,0,0,0,bodyCanvasWidth,bodyCanvasHeight,o),timer2=setInterval(drawBodyScene,100)}function Signature(){var e=new Image;e.src=website_url+"images/sign.png",e.onload=function(){ctx6.drawImage(e,0,0,172,87,200,410,120,61),exportResult()}}var website_url="./",bagInfo={female:[{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/001.png' class='bag' /> <h3>Quilted Lth Small Margot Carryall</h3> <p>货号：36679 IME8B</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/002.png' class='bag' /> <h3>Signature Mini Bennett Satchel</h3> <p>货号：36702 IME7P</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/003.png' class='bag' /> <h3>Twisted Gathered Kelsey Satchel</h3> <p>货号：37082 IMBLK</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/004.png' class='bag' /> <h3>Pebbled Leather Small Kelsey</h3> <p>货号：F37857SV/GM</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/005.png' class='bag' /> <h3>Crossgrain Minetta</h3> <p>货号：F36642IMBLK</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/006.png' class='bag' /> <h3>Floral Print Mini Christie</h3> <p>货号：F37421SV/M2</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/007.png' class='bag' /> <h3>Pebbled Leather Large Wristlet 19</h3> <p>货号：F53340IMBLK</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/008.png' class='bag' /> <h3>Exotic Trim Soft Wallet</h3> <p>货号：F53886SVER9</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"}],male:[{hintX:200,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/009.png' class='bag' /> <h3>Bowery Crossbody</h3> <p>货号：F71842BLK</p>  <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:200,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/010.png' class='bag' /> <h3>Bowery Crossbody Sig PVC</h3> <p>货号：F71877CQ/BK</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:200,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/011.png' class='bag' /> <h3>Small Sullivan Messenger </h3> <p>货号：F72108MID</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"},{hintX:70,hintY:210,html:"<div class='pale-popup mfp-with-anim text-center'><img src='"+website_url+"images/promo/brand1.png' class='brand' /> <img src='"+website_url+"images/promo/012.png' class='bag' /> <h3>Campus Backpack in Signature PVC</h3> <p>货号：F71973CQ/BK</p> <p>想了解产品详情，请至各大购物村官网的Coach专页</p> </div>"}]},gender="female",canvas,ctx,canvas2,ctx2,oHead,oFringe,oEye,oMouth,faceObject=[oHead,oFringe,oEye,oMouth],oColors,oColorEyebrow,oColorEye,oColorTop,oColorBack,canvas3,ctx3,canvas4,ctx4,canvas5,ctx5,canvas6,ctx6,oBody,oCloth,oBag,oShoes,oBackground,bodyObject=[oBackground,oBody,oShoes,oCloth,oBag],faceCanvasWidth=340,faceCanvasHeight=570,headPosX_onFacebuild=0,headPosY_onFacebuild=10,headScaleW_onFacebuild=1,headScaleH_onFacebuild=1,headPosY_onFacebuild_onIphone4=0,bodyCanvasWidth=340,bodyCanvasHeight=570,headPosX_female_onBodybuild=125,headPosY_female_onBodybuild=74,headScaleW_female_onBodybuild=74.4,headScaleH_female_onBodybuild=135.375,headPosX_male_onBodybuild=123,headPosY_male_onBodybuild=69,headScaleW_male_onBodybuild=80,headScaleH_male_onBodybuild=142.5,bodyPosX_onBodybuild=0,bodyPosY_onBodybuild=0,bodyScaleW_onBodybuild=1,bodyScaleH_onBodybuild=1,headScaleW_onMakeWishbuild=1,headScaleH_onMakeWishbuild=1,bodyScaleW_onMakeWishbuild=1,bodyScaleH_onMakeWishbuild=1,shoesBeforeCloth=!1,timer,timer2,loader,userMsg={context:"",text:$("#msg").val(),maxWidth:280,lineHeight:25,x:160,y:520,font:"25pt sans-serif",fillStyle:"#8d7141"},assetsItems=[],iSel=0,app={step:0,scene:$(".scene"),swiperLayer:$(".elementSwiper"),femaleFaceSwiperLayer:$(".elementSwiper.femaleFace"),maleFaceSwiperLayer:$(".elementSwiper.maleFace"),femaleBodySwiperLayer:$(".elementSwiper.femaleBody"),maleBodySwiperLayer:$(".elementSwiper.maleBody"),gameStart:$(".gameStart"),gameSteps:$(".nextStep,.prevStep"),nextStep:$(".nextStep"),prevStep:$(".prevStep"),faceItem:$(".faceItem"),faceOption:$(".faceOption"),bodyOption:$(".bodyOption"),bodyChoice:$(".bodyChoice"),bodyItem:$(".bodyItem").not(".ok"),bodyItemConfirm:$(".bodyItem").filter(".ok"),bodyItemHasBag:!1,bodyItemCancelBag:$(".elementSwiper").find(".cancelBag"),bodyBagHint:$(".bagHint"),shareHint:$(".shareHint"),generate:$("#generate"),shareqr:$("#shareqrpopup"),stepProgram:[{container:$(".startup"),stepFunction:function(){this.container.show().siblings().hide(),app.gameSteps.hide(),$(".btnBegin").on("click",function(){app.step=app.step+1,app.stepProgram[app.step].stepFunction(),$.magnificPopup.close()}),$(".open-popup-link").magnificPopup({type:"inline",midClick:!0,removalDelay:500,callbacks:{beforeOpen:function(){this.st.mainClass=this.st.el.attr("data-effect")}}})}},{container:$(".genderBuild"),stepFunction:function(){this.container.show().siblings().hide();var e=this.container;app.gameSteps.hide(),app.nextStep.show(),e.data("gender")||app.nextStep.addClass("disable"),clearInterval(timer),(new WOW).init(),$genderBtns=$(".genderBox .item"),$genderBtns.on("click",function(){gender=$(this).attr("val"),e.data("gender",gender).data("justSelect",!0),$genderBtns.removeClass("active unselect"),$(this).addClass("active").siblings().addClass("unselect"),app.nextStep.removeClass("disable")})}},{container:$(".faceBuild"),stepFunction:function(){this.container.show().siblings().hide();var e,a=this.container,t=0,i={direction:"vertical",swipeHandler:".bala",autoHeight:!1,setWrapperSize:!0,onSlideChangeEnd:function(e,a){t=e.activeIndex}};app.faceItem.fadeIn(2e3),app.prevStep.show(),"female"==gender?(app.femaleFaceSwiperLayer.show(),app.maleFaceSwiperLayer.hide(),app.faceOption.removeClass("male female").addClass("female"),this.container.removeClass("male female").addClass("female"),e=new Swiper(app.femaleFaceSwiperLayer,i)):(app.maleFaceSwiperLayer.show(),app.femaleFaceSwiperLayer.hide(),app.faceOption.removeClass("male female").addClass("male"),this.container.removeClass("male female").addClass("male"),e=new Swiper(app.maleFaceSwiperLayer,i)),document.documentElement.clientHeight<500&&(headPosY_onFacebuild=headPosY_onFacebuild_onIphone4);var n=function(){assetsPrepareForFace(gender,function(){a.data("gender",gender)})};a.data("gender")?a.data("gender")==gender||n():n(),app.faceItem.on("click",function(a){a.preventDefault(),$(this).addClass("active").siblings().removeClass("active"),e.slideTo($(this).attr("val"))});for(var o=0;o<faceObject.length;o++)faceObject[o].instance=new Swiper("."+gender+"Face "+faceObject[o].domEle,{onSlideChangeStart:function(e){faceObject[o].iSpr=parseInt(e.activeIndex)},centeredSlides:!1,slidesPerView:5,direction:"horizontal",allowSwipeToPrev:!1,allowSwipeToNext:!1,onTap:function(e,a){faceObject[t].iSpr=parseInt(e.clickedIndex)}})}},{container:$(".bodyBuild"),stepFunction:function(){this.container.show().siblings().hide(),app.bodyItemHasBag=!1,$(canvas5).hide();var e,a=this.container,t=4,i={direction:"horizontal",setWrapperSize:!0,autoHeight:!0,spaceBetween:5,swipeHandler:".bala",onInit:function(e,a){}};app.bodyItem.fadeIn(2e3),"female"==gender?(app.femaleBodySwiperLayer.show(),app.maleBodySwiperLayer.hide(),app.bodyOption.removeClass("male female").addClass("female"),this.container.removeClass("male female").addClass("female"),e=new Swiper(app.femaleBodySwiperLayer,i)):(gender="male",app.maleBodySwiperLayer.show(),app.femaleBodySwiperLayer.hide(),app.bodyOption.removeClass("male female").addClass("male"),this.container.removeClass("male female").addClass("male"),e=new Swiper(app.maleBodySwiperLayer,i));var n=function(){assetsPrepareForBody(gender,function(){a.data("gender",gender)})};a.data("gender")?a.data("gender")==gender||n():n(),1==app.bodyItemHasBag?($(canvas5).show(),app.bodyBagHint.show()):($(canvas5).hide(),app.bodyBagHint.hide()),app.bodyItem.on("click",function(i){i.preventDefault(),$(this).addClass("active").siblings().removeClass("active"),a.addClass("editMode"),e.slideTo($(this).attr("val")),t=$(this).attr("data-draw-squence")}),app.bodyItemConfirm.on("click",function(e){e.preventDefault(),a.removeClass("editMode")});for(var o=0;o<bodyObject.length;o++){var s="."+gender+"Body "+bodyObject[o].domEle;if($(s).size()>0){var c=$(s).find(".swiper-slide").size();bodyObject[o].instance=new Swiper(s,{onSlideChangeStart:function(e){bodyObject[o].iSpr=parseInt(e.activeIndex)},setWrapperSize:!0,centeredSlides:!1,slidesPerView:c,direction:"vertical",allowSwipeToPrev:!1,allowSwipeToNext:!1,onTap:function(e,a){"true"==$(bodyObject[t].instance.clickedSlide).attr("data-before-cloth")&&(shoesBeforeCloth=!0),bodyObject[t].iSpr=parseInt(e.clickedIndex),$(bodyObject[t].instance.clickedSlide).removeClass("unselectItem").addClass("activeItem").siblings().removeClass("activeItem").addClass("unselectItem")}})}}bodyObject[4].instance.on("onTap",function(e){app.bodyItemHasBag=!0,$(canvas5).show()}),app.bodyItemCancelBag.on("click",function(){app.bodyItemHasBag=!1,$(canvas5).hide()}),app.bodyBagHint.hide(),app.bodyItemConfirm.on("click",function(){if(1==app.bodyItemHasBag){var e=bagInfo[gender][bodyObject[4].iSpr].hintX,a=bagInfo[gender][bodyObject[4].iSpr].hintY;app.bodyBagHint.css({left:e,top:a}),app.bodyBagHint.show(),(new WOW).init()}else app.bodyBagHint.hide()}),app.bodyBagHint.on("click",function(){var e=bagInfo[gender][bodyObject[4].iSpr].html;$.magnificPopup.open({mainClass:"bag-info-popup mfp-3d-unfold",items:{src:"<div>"+e+"</div>"},showCloseBtn:!0,closeBtnInside:!0,closeMarkup:'<img src="'+website_url+'images/x.png" class="mfp-close" />',tError:'<a href="%url%">The content</a> could not be loaded.',type:"inline"})})}},{container:$(".makeWish"),stepFunction:function(){this.container.show().siblings().hide(),"number"==typeof timer&&clearInterval(timer2)}},{container:$(".contactInfo"),stepFunction:function(){this.container.show().siblings().hide(),Signature()}},{container:$(".share"),stepFunction:function(){this.container.show().siblings().hide(),app.shareHint.on("click",function(){$.magnificPopup.open({mainClass:"share-info-popup mfp-3d-unfold",items:{src:"<div></div>"},tError:'<a href="%url%">The content</a> could not be loaded.',type:"inline"})}),console.log("test"),app.shareqr.on("click",function(){$.magnificPopup.open({mainClass:"share-qr-popup mfp-3d-unfold",items:{src:'<div><img src="'+website_url+'/images/qr.png" width="300" height="300" /></div>'},tError:'<a href="%url%">The content</a> could not be loaded.',type:"inline"})})}}]};$(function(){checkPortrait(),$(window).on("resize",checkPortrait),$("#generate button").click(function(){exportResult()}),app.nextStep.on("click",function(){app.step<app.stepProgram.length-1&&0==app.nextStep.hasClass("disable")&&(app.step=app.step+1,app.stepProgram[app.step].stepFunction())}),app.prevStep.on("click",function(){app.step>0&&0==$(this).hasClass("disable")&&(app.step=app.step-1,app.scene.eq(app.step).show().siblings().hide())}),$("#share_result").size()>0?app.stepProgram[6].stepFunction():app.stepProgram[app.step].stepFunction()});